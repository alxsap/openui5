<!DOCTYPE html>
<html lang="en">

<head><meta charset="utf-8">
	<title>Custom the Field</title>
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script data-require-ui5-init src="../../../scripts/boot.js"></script>
</head>

<body class="sapUiBody sapUiSizeCompact topicBody">
	<div class="topic">
		<div class="content">
			<h1 id="overview">Custom the Field</h1>
			<p>
				Custom the field(parameter) to use other UI5 controls following below 2 ways:
			</p>
			<h2 id="extends">Extends class sap.ui.integration.editor.fields.viz.VizBase</h2>
			<p>
				VizBase is the base class of ColorSelect, ShapeSelect, IconSelect and ImageSelect supplied by Editor. Eextends it to use the UI5 Control.
			</p>
			<ol>
				<li>Extends class VizBase
					<pre class="lang-js">
sap.ui.define([
	&quot;sap/ui/integration/editor/fields/viz/VizBase&quot;,
	&quot;sap/m/DateRangeSelection&quot;,
	&quot;sap/base/util/merge&quot;
], function (
	VizBase, DateRangeSelection, merge
) {
	&quot;use strict&quot;;

	var CustomDateRangeSelection = VizBase.extend(&quot;sap.ui5.test.cardeditor.listcard.viz.CustomDateRangeSelection&quot;, {
		metadata: {
			library: &quot;sap.ui5.test.cardeditor.listcard&quot;,
			properties: {
				displayFormat: {
					type: &quot;string&quot;,
					defaultValue: &quot;&quot;
				}
			}
		},
		renderer: {
			apiVersion: 2
		}
	});

	return CustomDateRangeSelection;
});
</pre>
					<p>
						VizBase has 2 default properties: &quot;value&quot; and &quot;editable&quot;. Customer can add new properties, here is &quot;dispalyFormat&quot;.
					</p>
				</li>
				<li>Implement the onInit function
					<pre class="lang-js">
// create this._oControl and set up it
CustomDateRangeSelection.prototype.onInit = function () {
	this._oControl = new DateRangeSelection();
};
</pre>
					<p>
						In the onInit function, set this._oControl to the UI5 control.
					</p>
				</li>
				<li>Add the set function of new properties
					<pre class="lang-js">
CustomDateRangeSelection.prototype.setDisplayFormat = function (sValue) {
	this.setProperty(&quot;displayFormat&quot;, sValue, true);
	sValue = this.getDisplayFormat();
	this._oControl.setProperty(&quot;displayFormat&quot;, sValue);
	return this;
};
</pre>
				</li>
				<li>Bind the properties to the UI5 control
					<pre class="lang-js">
// bind propeties to this._oControl
CustomDateRangeSelection.prototype.bindPropertyToControl = function (sProperty, oBindingInfo) {
	VizBase.prototype.bindPropertyToControl.apply(this, arguments);
	if (sProperty === &quot;displayFormat&quot;) {
		var oControlBindingInfo = merge({}, oBindingInfo);
		this._oControl.bindProperty(&quot;displayFormat&quot;, oControlBindingInfo);
	}
};
</pre>
					<p>
						If customer want to bind value or editable to other property of the UI5 control, please not call the bindPropertyToControl of VizBase.
					</p><pre class="lang-js">
ShapeSelect.prototype.bindPropertyToControl = function (sProperty, oBindingInfo) {
	if (sProperty === &quot;editable&quot;) {
		var oControlBindingInfo = merge({}, oBindingInfo);
		this._oControl.bindProperty(&quot;enabled&quot;, oControlBindingInfo);
	}
	if (sProperty === &quot;value&quot;) {
		var oControlBindingInfo = merge({}, oBindingInfo);
		this._oControl.bindProperty(&quot;selectedKey&quot;, oControlBindingInfo);
	}
};
</pre>
					<p></p>
				</li>
				<li>Use the new class as visualization type of the property in Configuration
					<pre class="lang-js">
&quot;dateRange&quot;: {
	&quot;manifestpath&quot;: &quot;/sap.card/configuration/parameters/dateRange/value&quot;,
	&quot;type&quot;: &quot;string&quot;,
	&quot;label&quot;: &quot;Date Range&quot;,
	&quot;displayFormat&quot;: &quot;yyyy/MM/dd&quot;,
	&quot;visualization&quot;: {
		&quot;type&quot;: &quot;sap/ui5/test/cardeditor/listcard/viz/CustomDateRangeSelection&quot;,
		&quot;settings&quot;: {
			&quot;value&quot;: &quot;{currentSettings&gt;value}&quot;,
			&quot;editable&quot;: &quot;{currentSettings&gt;editable}&quot;,
			&quot;displayFormat&quot;: &quot;{currentSettings&gt;displayFormat}&quot;
		}
	}
},
</pre>
				</li>
			</ol>
			<a class="try-button" href="../../../index.html#/explore/playground/designtimeCustomField" target="_parent">Try it Out</a>
			<h2 id="fragment">Create fragment xml and controller files</h2>
			<p>
				Another way to implement this is using fragment.
			</p>
			<ol>
				<li>Create fragment xml view file
					<p>
						<img src="../img/fragmentXMLFile.PNG" alt style="margin:2px;width:800px;border:1px solid #f5f5f5">
					</p>
					<p>
						Use the UI5 Controls in the xml file, and the data models: &quot;currentSettings&quot;, &quot;items&quot;, &quot;i18n&quot;, &quot;context&quot;, &quot;contextflat&quot; and undefined.
					</p>
				</li>
				<li>Create controller.js File which extends sap.ui.integration.editor.fields.fragment.Controller
					<pre class="lang-js">
sap.ui.define([
	&quot;sap/ui/integration/editor/fields/fragment/Controller&quot;
], function(Controller) {
	&quot;use strict&quot;;

	var InputController = Controller.extend(&quot;sap.ui5.test.cardeditor.listcard.viz.Input&quot;, {
	});

	return InputController;
});
</pre>
				</li>
				<li>Implement the init function and the event handlers
					<pre class="lang-js">
InputController.prototype.init = function () {
	this._aa = &quot;aa&quot;;
};

InputController.prototype.handleChange = function (oEvent) {
	//add current change into translation texts
	var oControl = oEvent.getSource();
	var sValue = oControl.getValue();
	this.saveValue(sValue);
};
</pre>
					<p>In the init function, please define the needed properties.</p>
					<p>In the event handlers, if want to save the value, please call the saveValue function</p>
				</li>
				<li>Use the fragment as visualization.fragment in Configuration
					<pre class="lang-js">
&quot;cardTitle&quot;: {
	&quot;manifestpath&quot;: &quot;/sap.card/configuration/parameters/cardTitle/value&quot;,
	&quot;type&quot;: &quot;string&quot;,
	&quot;translatable&quot;: true,
	&quot;required&quot;: true,
	&quot;label&quot;: &quot;Card Title&quot;,
	&quot;allowDynamicValues&quot;: true,
	&quot;editableToUser&quot;: false,
	&quot;visibleToUser&quot;: true,
	&quot;description&quot;: &quot;Card Title&quot;,
	&quot;cols&quot;: 1,
	&quot;visualization&quot;: {
		&quot;fragment&quot;: &quot;sap/ui5/test/cardeditor/listcard/viz/Input&quot;
	}
}
</pre>
				</li>
			</ol>
			<a class="try-button" href="../../../index.html#/explore/playground/designtimeCustomField" target="_parent">Try it Out</a>
		</div>
	</div>
</body>

</html>